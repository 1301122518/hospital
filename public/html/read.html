<HTML>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" media="print" href="../public/stylesheets/main.css")">
</head>
<style type="text/css">
.STYLE1{
	font-family:"方正宋体-人口信息";}
.idCardInfo{
    margin-top:40px;
    margin-bottom:40px;
}
</style>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
   <center>
       <p ><font size="7" name="tResult">请将身份证放至感应区</font></p>
    <OBJECT
            classid="clsid:F1317711-6BDE-4658-ABAA-39E31D3704D3"
            codebase="SDRdCard.cab#version=1,3,6,1"
            width=299
            height=190
            align=center
            hspace=0
            vspace=0
            id=idcard
            name=rdcard
    >
    </OBJECT>
    <body  onbeforeunload="Unload()" >

    <form name=tcard action="http://127.0.0.1:9000/guide" method="post">
        <table class="idCardInfo">
            <tr>
                <td>
                    <table width="540" border="0">
                        <tr>
                            <td align="right">姓名</td>
                            <td><input name="tName" type="text" size="40" /></td>
                        </tr>
                        <tr>
                            <td align="right">公民身份号码</td>
                            <td><input name="tcardID" type="text" size="40" /></td>
                        </tr>
                        <tr>
                            <td align="right">住    址</td>
                            <td><input name="tAddr" type="text" size="40" /></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <!--<a name="praPass" href=""><button>打印体检单</button></a>-->
        <button type="submit">打印体检单</button>
    </form>

    <table width="280" border="0">
        <tr>
            <td><input type="button" value="打开机具"         style="width:140px;"    name="myopen"    onclick="myopen_onclick()"   /></td>
            <td><input type="button" value="开始读卡"         style="width:140px;"    name="beginread" onClick="beginread_onclick()"/></td>
        </tr>
    </table>
    </body>

    <script for=idcard event="Readed()">
      //alert('Readed');
      getinfo_onclick();
</script>

    <script for=idcard event="Closed()">
      //window.close();
</script>

    <script for=idcard event="Opened()">
      //window.close();
</script>

    <SCRIPT>

	function myopen_onclick(){
	var  pp ;
	pp=rdcard.openport();
        //alert(pp);
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].innerHTML="连接身份证扫描仪成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].innerHTML="连接身份证扫描仪失败: "+pp;
        }
    }

        function Unload(){
		MyClose_onclick();
		//alert("Page is Close");
	}


	function beginread_onclick(){

	var  pp
	pp=rdcard.ReadCard2();
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].innerHTML="请将身份证放到感应区...";
        }
        else
        {
            document.getElementsByName("tResult")[0].innerHTML="读取信息失败: "+pp;
        }
	}


	function showjpgIE6(){
        //alert('读照片成功');
        document.getElementsByName("photo")[0].src = "file:///C|/null.JPEG";

	if(rdcard.PhotoPath == "")
	  document.getElementsByName("photo")[0].src = "file:///C|/null.JPEG";
	else
	  document.getElementsByName("photo")[0].src = rdcard.PhotoPath	;
    }
	function showjpgIE8(){
        //alert('读照片成功');
        document.all['photo'].src  = 'data:image/jpeg;base64,' + rdcard.JPGBuffer;
    }


     function getinfo_onclick(){
	var  r1,r2;
	document.getElementsByName("tName")[0].value=rdcard.NameS;
	document.getElementsByName("tcardID")[0].value=rdcard.CardNo;
	document.getElementsByName("tAddr")[0].value=rdcard.Address;

        //document.getElementsByName("tResult")[0].value=idcard.sResultMsg;
        //document.all['photo'].src  = 'data:image/jpeg;base64,' + rdcard.JPGBuffer;

        document.getElementsByName("tResult")[0].innerHTML="成功读取身份证信息";

     }


	function MyClear_onclick(){
        var  pp
        pp = rdcard.ClearAll();
        getinfo_onclick();
        document.getElementsByName("tsNum")[0].value="";
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="清空成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="清空失败: "+pp;
        }
	}

	function window_onUnload(){
		  rdcard.DeleteOutputFile();
		  rdcard.DeleteAllPicture();
	}
</SCRIPT>
</HTML>
