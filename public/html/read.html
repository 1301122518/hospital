<HTML>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" media="print" href="../public/stylesheets/main.css")">
</head>
<H1  style = "color:#0000A0;" align=center ><font size="6">      神思第二代身份证验证系统——100型</font></H1>
<style type="text/css">
<!--
.STYLE1{
	font-family:"方正宋体-人口信息";}
.S1 {
	width:1002px;
	margin:0 auto;
	color:#01c;
	border:0;}
.S1 table{
	border:1px solid #707070;}
-->
</style>
<HR><center>
    <OBJECT
            classid="clsid:F1317711-6BDE-4658-ABAA-39E31D3704D3"
            codebase="SDRdCard.cab#version=1,3,6,1"
            width=299
            height=190
            align=center
            hspace=0
            vspace=0
            id=idcard
            name=rdcard
    >
    </OBJECT>
    <body  onbeforeunload="Unload()" >

    <table width="680" border="0">
        <tr>
            <td><input type="button" value="打开机具"         style="width:140px;"    name="myopen"    onclick="myopen_onclick()"   /></td>
            <td><input type="button" value="关闭机具"         style="width:140px;"    name="myclose"   onclick="myclose_onclick()"  /></td>
            <td><input type="button" value="开始读卡"         style="width:140px;"    name="beginread" onClick="beginread_onclick()"/></td>
            <td><input type="button" value="等待读卡"         style="width:140px;"    name="read3"     onclick="read3_onclick()"    /></td>
            <td><input type="button" value="停止读卡"         style="width:140px;"    name="endread"   onclick="endread_onclick()"  /></td>
        </tr>
        <tr>
            <td><input type="button" value="手动读卡"         style="width:140px;"  name="handread"  onclick="handread_onclick()"/></td>
            <td><input type="button" value="保存身份证图片"   style="width:140px;"  name="SaveCard"  onclick="SaveCard_onclick()"/></td>
            <td><input type="button" value="读设备模块号"     style="width:140px;"  name="ReadsNum"  onclick="ReadsNum_onclick()"/></td>
            <td><input type="button" value="设置文件路径"     style="width:140px;"  name="savepath"  onclick="savepath_onclick()"/></td>
            <td><input type="button" value="清空所有属性"     style="width:140px;"  name="MyClear"   onClick="MyClear_onclick()"/></td>
        </tr>
    </table>
    <form name=tcard action="http://127.0.0.1:9000/guide" method="post">
        <table class="s1" >
            <tr>
                <td>
                    <table width="820" border="1" style="color:#0011CC"  >
                        <tr>
                            <td align="right">提示信息</td>
                            <td><input name="tResult" type="text" size="40" /></td>
                            <td align="right">设备模块号</td>
                            <td><input name="tsNum" type="text" size="40" /></td>
                        </tr>
                        <tr>
                            <td align="right">姓名name</td>
                            <td><input name="tName" type="text" size="40" /></td>
                            <td align="right">姓名nameL</td>
                            <td><input name="tNameL" type="text" size="40" /></td>
                        </tr>
                        <tr>
                            <td align="right">公民身份号码</td>
                            <td><input name="tcardID" type="text" size="40" /></td>
                            <td align="right">住    址</td>
                            <td><input name="tAddr" type="text" size="40" /></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <!--<a name="praPass" href=""><button>打印体检单</button></a>-->
        <button type="submit">打印体检单</button>
    </form>

    </body>

    <script for=idcard event="Readed()">
      //alert('Readed');
      getinfo_onclick();
</script>

    <script for=idcard event="Closed()">
      //window.close();
</script>

    <script for=idcard event="Opened()">
      //window.close();
</script>

    <SCRIPT>

	function myopen_onclick(){
	var  pp ;
	pp=rdcard.openport();
        //alert(pp);
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="openport成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="openport失败: "+pp;
        }
    }

	function myclose_onclick(){
	var  pp
	pp=rdcard.closeport();
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="closeport成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="closeport失败: "+pp;
        }
	}
        function Unload(){
		MyClose_onclick();
		//alert("Page is Close");
	}

	function endread_onclick(){
	var  pp
	pp=rdcard.endread();
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="endread成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="endread失败: "+pp;
        }
	}

	function handread_onclick(){

	var  pp
	pp=rdcard.readcard();
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="readcard成功";
            //showjpg_onclick();
        }
        else
        {
            document.getElementsByName("tResult")[0].value="readcard失败: "+pp;
        }
	}

	function beginread_onclick(){

	var  pp
	pp=rdcard.ReadCard2();
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="ReadCard2成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="ReadCard2失败: "+pp;
        }
	}
	function read3_onclick(){

	var  pp
	pp=rdcard.ReadCard3();
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="ReadCard3成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="ReadCard3失败: "+pp;
        }
	}

	function ReadsNum_onclick(){
	var  pp
	pp = rdcard.ReadSecurityNum();
	if(pp==0)
        {
            document.getElementsByName("tsNum")[0].value=rdcard.SecurityNum;
            document.getElementsByName("tResult")[0].value=rdcard.sResultMsg;
        }
        else
        {
            document.getElementsByName("tsNum")[0].value="读模块号码失败";
            document.getElementsByName("tResult")[0].value="读模块号码失败: "+pp;
        }
	}


	function showjpgIE6(){
        //alert('读照片成功');
        document.getElementsByName("photo")[0].src = "file:///C|/null.JPEG";

	if(rdcard.PhotoPath == "")
	  document.getElementsByName("photo")[0].src = "file:///C|/null.JPEG";
	else
	  document.getElementsByName("photo")[0].src = rdcard.PhotoPath	;
    }
	function showjpgIE8(){
        //alert('读照片成功');
        document.all['photo'].src  = 'data:image/jpeg;base64,' + rdcard.JPGBuffer;
    }


     function getinfo_onclick(){
	var  r1,r2;
	document.getElementsByName("tName")[0].value=rdcard.NameS;
	document.getElementsByName("tNameL")[0].value=rdcard.NameL;
	document.getElementsByName("tcardID")[0].value=rdcard.CardNo;
	document.getElementsByName("tAddr")[0].value=rdcard.Address;
	document.getElementsByName("tnewAddr")[0].value=rdcard.newAddress;
	document.getElementsByName("tnewAddr")[0].value=rdcard.newAddress;
	alert(document.getElementsByName("praPass")[0].setAttribute("href",rdcard.CardNo));


        document.getElementsByName("tResult")[0].value=idcard.sResultMsg;
        document.all['photo'].src  = 'data:image/jpeg;base64,' + rdcard.JPGBuffer;

     }



  	function SaveCard_onclick(){
	var  pp
	pp = rdcard.SaveCardPic("C:\\cardh.jpg","C:\\cards.jpg",3);
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="保存成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="保存失败: "+pp;
        }
	}

	function savepath_onclick(){
	rdcard.strSavePath= "c:\\aa";
	document.getElementsByName("tResult")[0].value="路径设置成功";
	}


	function MyClear_onclick(){
        var  pp
        pp = rdcard.ClearAll();
        getinfo_onclick();
        document.getElementsByName("tsNum")[0].value="";
	if(pp==0)
        {
	    document.getElementsByName("tResult")[0].value="清空成功";
        }
        else
        {
            document.getElementsByName("tResult")[0].value="清空失败: "+pp;
        }
	}


	function window_onUnload(){
		  rdcard.DeleteOutputFile();
		  rdcard.DeleteAllPicture();
	}
</SCRIPT>
</HTML>
